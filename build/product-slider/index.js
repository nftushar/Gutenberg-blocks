(()=>{"use strict";const e=window.wp.blocks,t=window.React,r=window.wp.blockEditor,n=window.wp.components,l=window.wp.i18n,o=window.wp.element,a=window.wp.data;(0,e.registerBlockType)("blockxpert/product-slider",{edit:function({attributes:e,setAttributes:i}){const[c,p]=(0,o.useState)([]),[s,d]=(0,o.useState)([]),[u,m]=(0,o.useState)(!0),[w,g]=(0,o.useState)(0),{title:b,productsPerSlide:v,autoPlay:h,showNavigation:_,showPagination:x,category:k,orderBy:f,order:E}=e,y=(0,a.useSelect)((e=>{const{__unstableGetPreviewDeviceType:t}=e(r.store);return t?t():"Desktop"}),[]);(0,o.useEffect)((()=>{window.wp&&window.wp.apiFetch&&window.wp.apiFetch({path:"/wc/v3/products/categories?per_page=100"}).then((e=>{p(e)})).catch((e=>{console.error("Error fetching categories:",e)}))}),[]),(0,o.useEffect)((()=>{if(window.wp&&window.wp.apiFetch){m(!0),g(0);let e="/wc/v3/products?per_page=12&status=publish";k&&(e+=`&category=${k}`),e+=`&orderby=${f}&order=${E}`,window.wp.apiFetch({path:e}).then((e=>{d(e),m(!1)})).catch((e=>{console.error("Error fetching products:",e),m(!1)}))}}),[k,f,E]);const C=[{label:(0,l.__)("All Categories","blockxpert"),value:""},...c.map((e=>({label:e.name,value:e.id.toString()})))],N=[{label:(0,l.__)("Date","blockxpert"),value:"date"},{label:(0,l.__)("Title","blockxpert"),value:"title"},{label:(0,l.__)("Price","blockxpert"),value:"price"},{label:(0,l.__)("Popularity","blockxpert"),value:"popularity"},{label:(0,l.__)("Rating","blockxpert"),value:"rating"}],P=[{label:(0,l.__)("Descending","blockxpert"),value:"desc"},{label:(0,l.__)("Ascending","blockxpert"),value:"asc"}],S="Mobile"===y?1:"Tablet"===y?Math.min(2,v):v,T=s.length>0?Math.ceil(s.length/S):0,A=()=>{g((e=>(e+1)%T))};return(0,o.useEffect)((()=>{if(!h||T<=1)return;const e=setInterval(A,5e3);return()=>clearInterval(e)}),[h,T]),(0,t.createElement)("div",{...(0,r.useBlockProps)()},(0,t.createElement)(r.InspectorControls,null,(0,t.createElement)(n.PanelBody,{title:(0,l.__)("Slider Settings","blockxpert"),initialOpen:!0},(0,t.createElement)(n.TextControl,{label:(0,l.__)("Slider Title","blockxpert"),value:b,onChange:e=>i({title:e}),placeholder:(0,l.__)("Enter slider title...","blockxpert")}),(0,t.createElement)(n.RangeControl,{label:(0,l.__)("Products per Slide","blockxpert"),value:v,onChange:e=>i({productsPerSlide:e}),min:1,max:6}),(0,t.createElement)(n.ToggleControl,{label:(0,l.__)("Auto Play","blockxpert"),checked:h,onChange:e=>i({autoPlay:e})}),(0,t.createElement)(n.ToggleControl,{label:(0,l.__)("Show Navigation Arrows","blockxpert"),checked:_,onChange:e=>i({showNavigation:e})}),(0,t.createElement)(n.ToggleControl,{label:(0,l.__)("Show Pagination Dots","blockxpert"),checked:x,onChange:e=>i({showPagination:e})})),(0,t.createElement)(n.PanelBody,{title:(0,l.__)("Product Settings","blockxpert"),initialOpen:!1},(0,t.createElement)(n.SelectControl,{label:(0,l.__)("Product Category","blockxpert"),value:k,options:C,onChange:e=>i({category:e})}),(0,t.createElement)(n.SelectControl,{label:(0,l.__)("Order By","blockxpert"),value:f,options:N,onChange:e=>i({orderBy:e})}),(0,t.createElement)(n.SelectControl,{label:(0,l.__)("Order","blockxpert"),value:E,options:P,onChange:e=>i({order:e})}))),(0,t.createElement)("div",{className:"product-slider-editor-preview"},(0,t.createElement)("h3",{className:"slider-title"},b||(0,l.__)("WooCommerce Product Slider","blockxpert")),u&&(0,t.createElement)(n.Placeholder,{label:(0,l.__)("Loading Products","blockxpert")},(0,t.createElement)("p",null,(0,l.__)("Fetching products for the preview...","blockxpert"))),!u&&0===s.length&&(0,t.createElement)(n.Placeholder,{icon:"woocommerce",label:(0,l.__)("No Products Found","blockxpert"),instructions:(0,l.__)("No products were found. Please check your product visibility, selected category, or try creating new products.","blockxpert")},(0,t.createElement)("a",{className:"components-button is-primary",href:"/wp-admin/post-new.php?post_type=product",target:"_blank",rel:"noopener noreferrer"},(0,l.__)("Create New Product","blockxpert"))),!u&&s.length>0&&(0,t.createElement)("div",{className:"slider-container-preview"},(0,t.createElement)("div",{className:"slider-wrapper-preview"},(0,t.createElement)("div",{className:"slider-track-preview",style:{display:"flex",transition:"transform 0.5s ease-in-out",transform:`translateX(-${100*w}%)`}},s.map((e=>(0,t.createElement)("div",{key:e.id,className:"product-item-preview",style:{flex:`0 0 ${100/S}%`,padding:"0 8px"}},(0,t.createElement)("div",{className:"product-card-preview"},(0,t.createElement)("div",{className:"product-image-preview"},e.images&&e.images[0]?(0,t.createElement)("img",{src:e.images[0].src,alt:e.name}):(0,t.createElement)("div",{className:"product-image-placeholder"},(0,t.createElement)("span",null,(0,l.__)("No Image","blockxpert")))),(0,t.createElement)("div",{className:"product-info-preview"},(0,t.createElement)("h4",{className:"product-title-preview"},e.name),(0,t.createElement)("p",{className:"product-price-preview",dangerouslySetInnerHTML:{__html:e.price_html||e.price}})))))))),_&&T>1&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("button",{className:"slider-nav-preview prev",onClick:()=>{g((e=>(e-1+T)%T))}},"‹"),(0,t.createElement)("button",{className:"slider-nav-preview next",onClick:A},"›")),x&&T>1&&(0,t.createElement)("div",{className:"slider-pagination-preview"},Array.from({length:T}).map(((e,r)=>(0,t.createElement)("button",{key:r,className:"dot-preview "+(w===r?"active":""),onClick:()=>(e=>{g(e)})(r),"aria-label":`${(0,l.__)("Go to slide","blockxpert")} ${r+1}`})))))),(0,t.createElement)("style",null,"\n                .product-slider-editor-preview .slider-title {\n                    text-align: center;\n                    font-size: 1.5em;\n                    margin-bottom: 1em;\n                }\n                .slider-container-preview {\n                    position: relative;\n                }\n                .slider-wrapper-preview {\n                    overflow: hidden;\n                }\n                .product-card-preview {\n                    border: 1px solid #e0e0e0;\n                    border-radius: 4px;\n                    overflow: hidden;\n                    background: #fff;\n                }\n                .product-image-preview {\n                    width: 100%;\n                    padding-top: 100%; /* 1:1 Aspect Ratio */\n                    position: relative;\n                    background-color: #f0f0f0;\n                }\n                .product-image-preview img {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    object-fit: cover;\n                }\n                .product-image-placeholder {\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    color: #999;\n                }\n                .product-info-preview {\n                    padding: 12px;\n                }\n                .product-title-preview {\n                    font-size: 1em;\n                    margin: 0 0 8px 0;\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                }\n                .product-price-preview {\n                    font-size: 0.9em;\n                    font-weight: bold;\n                    color: #2c3e50;\n                    margin: 0;\n                }\n                .slider-nav-preview {\n                    position: absolute;\n                    top: 40%;\n                    transform: translateY(-50%);\n                    background: rgba(255, 255, 255, 0.8);\n                    border: 1px solid #ccc;\n                    border-radius: 50%;\n                    width: 32px;\n                    height: 32px;\n                    cursor: pointer;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    z-index: 10;\n                }\n                .slider-nav-preview.prev { left: -10px; }\n                .slider-nav-preview.next { right: -10px; }\n                .slider-pagination-preview {\n                    text-align: center;\n                    margin-top: 16px;\n                }\n                .dot-preview {\n                    display: inline-block;\n                    width: 10px;\n                    height: 10px;\n                    border-radius: 50%;\n                    background: #ccc;\n                    margin: 0 4px;\n                    border: none;\n                    padding: 0;\n                    cursor: pointer;\n                }\n                .dot-preview.active { background: #333; }\n            "))},save:()=>null})})();